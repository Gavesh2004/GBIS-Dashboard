<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Student Card with All JSON Fields</title>
    <link rel="stylesheet" href="src/styles/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-title {
            color: white;
            text-align: center;
            margin-bottom: 30px;
        }
        #students-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="test-title">Enhanced Student Card Test</h1>
        <div id="students-container"></div>
    </div>

    <script>
        // Mock ContactsManager class for testing
        class MockContactsManager {
            constructor() {
                this.testData = {
                    "row_number": 2,
                    "Class": "NURSERY",
                    "Roll_No": 1,
                    "Serial_No": 2254,
                    "Name": "AAHIL KHAN",
                    "Father_Name": "ARSAD KHAN",
                    "Mother_Name": "REHANA BANO",
                    "DOB": "14-08-2020",
                    "Admission_Date": "02-04-2025",
                    "Address": "HODSAR",
                    "Contact_No": 7398226246,
                    "Transportaion_fees": 9000,
                    "Tution_fees ": 16000,
                    "Total_fees": 25000,
                    "Pending_fees ": 25000,
                    "Deposited_fees": 0,
                    "Discount_Amt": 0,
                    "Disc_reason": "NA"
                };
                this.render();
            }

            createStudentCard(student) {
                const card = document.createElement('div');
                card.className = 'student-card';

                const safe = (v) => v || '—';
                const formatCurrency = (amount) => {
                    if (!amount || amount === 0) return '₹0';
                    return `₹${Number(amount).toLocaleString('en-IN')}`;
                };
                const formatContactNumber = (contact) => {
                    if (!contact) return '—';
                    const str = String(contact);
                    return str.length === 10 ? str.replace(/(\d{5})(\d{5})/, '$1-$2') : str;
                };

                card.innerHTML = `
                    <div class="student-header">
                        <h4 class="student-name">${safe(student.Name)}</h4>
                        <span class="student-class">${safe(student.Class)}</span>
                    </div>
                    <div class="student-meta">
                        <div class="meta"><span class="meta-label">Roll</span><span class="meta-value">${safe(student.Roll_No)}</span></div>
                        <div class="meta"><span class="meta-label">Serial</span><span class="meta-value">${safe(student.Serial_No)}</span></div>
                        <div class="meta"><span class="meta-label">Father</span><span class="meta-value">${safe(student.Father_Name)}</span></div>
                        <div class="meta"><span class="meta-label">Mother</span><span class="meta-value">${safe(student.Mother_Name)}</span></div>
                        <div class="meta"><span class="meta-label">DOB</span><span class="meta-value">${safe(student.DOB)}</span></div>
                        <div class="meta"><span class="meta-label">Admission</span><span class="meta-value">${safe(student.Admission_Date)}</span></div>
                        <div class="meta" style="grid-column: span 2"><span class="meta-label">Address</span><span class="meta-value">${safe(student.Address)}</span></div>
                        <div class="meta"><span class="meta-label">Contact</span><span class="meta-value em">${formatContactNumber(student.Contact_No)}</span></div>
                    </div>
                    
                    <div class="student-fees-section">
                        <h5 class="fees-section-title">
                            <i class="fas fa-money-bill-wave"></i>
                            Fee Details
                        </h5>
                        <div class="fees-grid">
                            <div class="fee-item">
                                <span class="fee-label">Transportation</span>
                                <span class="fee-value">${formatCurrency(student.Transportaion_fees || student.Transportaion_Fees)}</span>
                            </div>
                            <div class="fee-item">
                                <span class="fee-label">Tuition</span>
                                <span class="fee-value">${formatCurrency(student.Tution_fees || student['Tution_fees '])}</span>
                            </div>
                            <div class="fee-item total-fee">
                                <span class="fee-label">Total Fees</span>
                                <span class="fee-value">${formatCurrency(student.Total_fees)}</span>
                            </div>
                            <div class="fee-item deposited-fee">
                                <span class="fee-label">Deposited</span>
                                <span class="fee-value">${formatCurrency(student.Deposited_fees)}</span>
                            </div>
                            <div class="fee-item pending-fee">
                                <span class="fee-label">Pending</span>
                                <span class="fee-value">${formatCurrency(student.Pending_fees || student['Pending_fees '])}</span>
                            </div>
                            <div class="fee-item discount-fee">
                                <span class="fee-label">Discount</span>
                                <span class="fee-value">${formatCurrency(student.Discount_Amt)}</span>
                            </div>
                        </div>
                        ${student.Disc_reason && student.Disc_reason !== 'NA' ? `
                            <div class="discount-reason">
                                <span class="discount-label">Discount Reason:</span>
                                <span class="discount-text">${student.Disc_reason}</span>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="student-actions">
                        <button class="action-btn view-details-btn" onclick="mockContactsManager.showStudentDetails('${student.Serial_No || student.row_number}')">
                            <i class="fas fa-eye"></i>
                            View Details
                        </button>
                        <button class="action-btn send-notification-btn" onclick="mockContactsManager.sendNotificationToStudent('${student.Serial_No || student.row_number}')">
                            <i class="fas fa-bell"></i>
                            Send Notice
                        </button>
                    </div>
                `;

                return card;
            }

            showStudentDetails(studentId) {
                console.log('Show details for student:', studentId);
                alert(`Show detailed popup for student ID: ${studentId}\n\nThis would open the detailed popup with all student information including comprehensive fee breakdown.`);
            }

            sendNotificationToStudent(studentId) {
                console.log('Send notification to student:', studentId);
                alert(`Send notification to student ID: ${studentId}\n\nThis would redirect to the notification tab with pre-filled student information.`);
            }

            render() {
                const container = document.getElementById('students-container');
                if (container) {
                    const studentCard = this.createStudentCard(this.testData);
                    
                    // Create a few variations for testing
                    const studentCard2 = this.createStudentCard({
                        ...this.testData,
                        Name: "SARA ALI",
                        Serial_No: 2255,
                        Roll_No: 2,
                        Deposited_fees: 15000,
                        "Pending_fees ": 10000,
                        Discount_Amt: 2000,
                        Disc_reason: "Academic Excellence"
                    });

                    const studentCard3 = this.createStudentCard({
                        ...this.testData,
                        Name: "RAHUL SHARMA",
                        Serial_No: 2256,
                        Roll_No: 3,
                        Class: "5TH",
                        Deposited_fees: 25000,
                        "Pending_fees ": 0,
                        Discount_Amt: 0,
                        Disc_reason: "NA"
                    });

                    container.appendChild(studentCard);
                    container.appendChild(studentCard2);
                    container.appendChild(studentCard3);
                }
            }
        }

        // Initialize test
        document.addEventListener('DOMContentLoaded', () => {
            window.mockContactsManager = new MockContactsManager();
            console.log('Enhanced Student Card Test Loaded');
            console.log('Test data includes all fields from JSON response:');
            console.log('- Personal Information (Name, Class, Roll, Serial, DOB, Admission Date)');
            console.log('- Family Information (Father Name, Mother Name, Address, Contact)');
            console.log('- Fee Details (Transportation, Tuition, Total, Deposited, Pending, Discount)');
            console.log('- Actions (View Details, Send Notification)');
        });
    </script>
</body>
</html>